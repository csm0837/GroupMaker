# 수련회 조 배정 시스템

이 프로그램은 수련회 조 배정을 자동화하는 Python 스크립트입니다. **웹 인터페이스**와 **명령줄 인터페이스** 두 가지 방식으로 사용할 수 있습니다.

## 🚀 빠른 시작 (웹 애플리케이션)

### 1. 의존성 설치
```bash
pip install -r requirements.txt
```

### 2. 웹 애플리케이션 실행
```bash
python app.py
```

### 3. 웹 브라우저에서 접속
```
http://localhost:8080
```

### 4. 파일 업로드 및 조 배정
1. **조장/헬퍼 명단** Excel 파일 업로드
2. **조원 명단** Excel 파일 업로드
3. **조 배정 시작** 버튼 클릭
4. 결과 확인 및 파일 다운로드

## 📋 기능

### 필수 조건
1. **의대 24학번과 25학번 분리**: 같은 조에 의대 24학번과 25학번이 함께 배정되지 않습니다.
2. **같은 학교 금지**: 같은 조에는 같은 학교 학생이 배정되지 않습니다.

### 최적화 조건
0. **나이 제한**: 조원들은 헬퍼보다 나이가 어려야 합니다. (37세 조장이 있는 조는 39세까지 허용)
1. **성비 균형**: 각 조의 남녀 비율이 전체 성비와 비슷하게 유지됩니다.
2. **학과 분포**: 의대, 치대, 한의대, 간호대 학생들은 각 조에 2명 이상씩 배정됩니다.
3. **지역 다양성**: 최대한 다양한 지역의 학생들로 구성됩니다.

## 🌐 웹 애플리케이션 사용법

### 메인 페이지
- **드래그 앤 드롭** 또는 **파일 선택** 버튼으로 Excel 파일 업로드
- 실시간 파일 유효성 검사
- 진행률 표시 및 애니메이션

### 결과 페이지
- **조별 요약 테이블**: 조건 충족 여부를 한눈에 확인
- **조별 상세 정보**: 조장, 헬퍼, 조원들의 상세 정보
- **통계 정보**: 성별 분포, 학과 분포, 지역 분포
- **파일 다운로드**: 조 배정 결과 및 요약 보고서 CSV 다운로드

## 💻 명령줄 인터페이스

### 샘플 데이터 생성 (테스트용)
```bash
python create_sample_data.py
```

### 조 배정 실행
```bash
python camp_group_assignment.py --leaders jojanghelpeo.xlsx --members joweonmyeongdan.xlsx --out final_group_assignment.csv
```

## 📁 입력 파일 형식

### 조장/헬퍼 명단 (jojanghelpeo.xlsx)
- **Sheet 이름**: Sheet1
- **필수 컬럼**:
  - `조 숫자`: 조 번호
  - `조장or헬퍼`: "조장" 또는 "헬퍼"
  - `이름`: 이름
  - `학과`: 학과명
  - `학번`: 학번
  - `나이`: 나이
  - `학교/학년`: 학교명
  - `성별`: "남" 또는 "여"

### 조원 명단 (joweonmyeongdan.xlsx)
- **Sheet 이름**: 등록 데이터
- **필수 컬럼**:
  - `이름`: 이름
  - `학과`: 학과명
  - `학번`: 학번
  - `나이`: 나이 (예: "25세")
  - `캠퍼스`: 학교명
  - `성별`: "남" 또는 "여"

## 📊 출력 파일

### 1. 조 배정 결과 (final_group_assignment.csv)
- 조 번호별로 조장, 헬퍼, 조원들의 상세 정보
- 컬럼: 조 번호, 역할, 이름, 학과, 학번, 나이, 학교, 성별

### 2. 조별 요약 보고서 (final_group_assignment_summary.csv)
- 각 조의 통계 정보
- 조건 충족 여부 (✓/✗)
- 성별 분포, 학과 분포, 지역 분포

## 🎯 사용 예시

### 웹 애플리케이션
```bash
# 1. 웹 애플리케이션 실행
python app.py

# 2. 웹 브라우저에서 http://localhost:8080 접속

# 3. 파일 업로드 및 조 배정
# 4. 결과 확인 및 다운로드
```

### 명령줄
```bash
# 1. 샘플 데이터 생성
python create_sample_data.py

# 2. 조 배정 실행
python camp_group_assignment.py --leaders jojanghelpeo.xlsx --members joweonmyeongdan.xlsx --out final_group_assignment.csv

# 3. 결과 확인
cat final_group_assignment_summary.csv
```

## ⚠️ 주의사항

1. Excel 파일의 컬럼명이 정확히 일치해야 합니다.
2. 나이 데이터는 숫자 형식이어야 합니다 (조원 명단의 경우 "세" 제거됨).
3. 학교명은 자동으로 정규화됩니다 (예: "서울대학교" → "서울대").
4. 의대 24/25학번 분리는 학번의 마지막 2자리를 기준으로 합니다.
5. 웹 애플리케이션은 기본적으로 8080 포트에서 실행됩니다.

## 🔧 문제 해결

- **데이터 로딩 오류**: Excel 파일의 컬럼명과 Sheet 이름을 확인하세요.
- **조 배정 실패**: 조건이 너무 엄격한 경우 일부 조건을 완화하거나 조 수를 늘려보세요.
- **성비 불균형**: 전체 성비가 극단적인 경우 수동 조정이 필요할 수 있습니다.
- **포트 충돌**: 8080 포트가 사용 중인 경우 `app.py`에서 포트를 변경하세요.

## 📁 프로젝트 구조

```
수련회 조 배정 시스템/
├── app.py                          # 웹 애플리케이션 (Flask)
├── camp_group_assignment.py        # 조 배정 로직
├── create_sample_data.py           # 샘플 데이터 생성
├── requirements.txt                # Python 패키지 의존성
├── README.md                       # 사용법 설명
├── templates/                      # HTML 템플릿
│   ├── index.html                  # 메인 페이지
│   └── results.html                # 결과 페이지
├── uploads/                        # 업로드된 파일 저장소
└── results/                        # 조 배정 결과 저장소
```

## 🎨 웹 인터페이스 특징

- **반응형 디자인**: 모바일, 태블릿, 데스크톱 모든 기기에서 사용 가능
- **드래그 앤 드롭**: 파일을 쉽게 업로드할 수 있습니다
- **실시간 검증**: 파일 업로드 시 즉시 유효성 검사
- **진행률 표시**: 조 배정 처리 과정을 시각적으로 확인
- **아름다운 UI**: Bootstrap과 Font Awesome을 활용한 현대적인 디자인 